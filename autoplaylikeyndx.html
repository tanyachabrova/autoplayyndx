<!DOCTYPE html>
<html>
<head>
    <title>Redirecting to Yandex Music</title>
    <script type="text/javascript">
        var clientId = "YOUR_CLIENT_ID"; // Replace with your Yandex OAuth Client ID
        var redirectUri = window.location.origin + window.location.pathname; // Current page
        
        function getAccessToken() {
            var match = window.location.hash.match(/access_token=([^&]+)/);
            if (match) {
                var token = match[1];
                localStorage.setItem("yandex_token", token); // Save token
                history.replaceState({}, document.title, window.location.pathname); // Remove token from URL
                return token;
            }
            return localStorage.getItem("yandex_token"); // Get stored token
        }

        async function likeAndRedirect() {
            var trackId = "131441112"; // Track ID
            var albumId = "33416599";  // Album ID
            var token = getAccessToken();

            if (!token) {
                window.location.href = `https://oauth.yandex.ru/authorize?response_type=token&client_id=${clientId}&redirect_uri=${redirectUri}`;
                return;
            }

            // API request to like the track
            try {
                await fetch("https://api.music.yandex.net/users/library/likes/tracks/" + trackId, {
                    method: "POST",
                    headers: {
                        "Authorization": "OAuth " + token
                    }
                });
                console.log("Track liked successfully!");
            } catch (error) {
                console.error("Failed to like the track:", error);
            }

            // Redirect to the Yandex Music app to play the song
            var deepLink = "yandexmusic://track/" + trackId + "?play=1";
            var webLink = "https://music.yandex.ru/album/" + albumId + "/track/" + trackId + "?play=true";

            window.location.href = deepLink;
            setTimeout(function () {
                window.location.href = webLink; // Fallback if deep link fails
            }, 1500);
        }
    </script>
</head>
<body onload="likeAndRedirect()">
    <p>Redirecting to Yandex Music...</p>
</body>
</html>
